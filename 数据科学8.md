# Lecture 8
## Trapezoid Rule（梯形法）

$\int_{a}^{b}\,f(x)dx\approx \sum\limits_{k=0}^{N-1}\frac{1}{2}(f(x_k)+f(x_{k+1}))\Delta x$
> ```matlab
> trapz(X,Y)
> ```
> $Error:O(\Delta x^2)$
Issue:high curvatur is bad

* Composite Rule:$\sum\limits_{k=0}^{N-1}\frac{1}{2}(f(x_k)+f(x_{k+1}))\Delta x=\frac{\Delta x}{2}[f(x_0)+f(x_N)+2\sum\limits_{k=1}^{N-1}f(x_k)]$

## New Perspective
### Simpson Rule
近似的本质是利用离散点的信息。用左端右端的方法只用了一个点的信息，梯形法就用了两个点。
如果要用三个点的信息，就是计算三个点所成抛物线所围的面积。
* 近似方法：拉格朗日多项式$p(x)=\sum\limits_{_k=0}^{n}f(x_k)\frac{(x-x_1)...(x-x_{k-1})(x-x_{k+1})...(x-x_n)}{(x_k-x_1)...(x_k-x_{k-1})(x_k-x_{k+1})...(x_k-x_n)}$
在二次情形下有$\int_{a}^{b}\,f(x)dx\approx \frac{\Delta x}{3}\sum\limits_{k=1}^{N}[f(x_{2k-2})+4f(x_{2k-1})+f(x_{2k})],where\,[a,b]is\,spilt\,into\,2N\,[x_k,x_{k+1}]with\,width\,\Delta x=\frac{b-a}{2N},k=0,1,2,...,2N.O(\Delta x^3)$
> 其他算法有$Simpson\frac{3}{8},Bode's\,role$等
> $Newton-Cotes\,Formula$

## Ordinary Differential Equations（常微分方程）
$x'=f(x)$，其中x是一个状态向量
### Linear
$x'=Ax，x(0)=x_0$，线性系统linear system
solution:$x(t)=e^{At}x_0$，其中前者是矩阵，后者是向量
> 由于指数函数可以用级数定义，故前者计算结果是一个矩阵
我们实际上想解决的就是解出从$x_0-x_n$的结果，所以我们可以迭代计算，即使写不出来显性表达式。
#### 数值逼近
$Forward\,Euler$
$\frac{x_{k+1}-x_k}{\Delta t}\approx x'_k=f(x_k)$，故有
$x_{k+1}\approx x_k+\Delta t f(x_k)$
在线性情况中则为$x_{k+1}\approx (I+\Delta t A)x_k$
同样的有$Backward\,Euler(Implicit Euler)$:$x_{k+1}=x_k+\Delta t f(x_{k+1})$

虽然一般的是隐函数，但在线性条件下有显性解：$x_{k+1}=(I-\Delta t A)^{-1}x_k$
* 后者稳定性更好，意思是适用于更多的问题（不然会发散）
### Spring-Mess-Damper system
根据物理场景列方程有$mx''=-kx-cx'$
即$x''+\frac{c}{m}x'+\frac{k}{m}x=0$
用降次：令$x'=v$，则有$v'=-\frac{c}{m}v-\frac{k}{m}x$
整理成矩阵形式有$\frac{d}{dt}\begin{bmatrix}x\\v\end{bmatrix}=\begin{bmatrix}0&1\\-\frac{k}{m}&-\frac{c}{m}\end{bmatrix}\begin{bmatrix}x\\v\end{bmatrix}$